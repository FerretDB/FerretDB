---
name: Debug
on:
  pull_request:
    types:
      - labeled # for `trusted` label
      - unlabeled
      - opened
      - reopened
      - synchronize

jobs:
  contexts:
    name: Contexts
    runs-on: ubuntu-22.04

    # FIXME
    # if: >
    #   contains(github.event.pull_request.labels.*.name, 'trust') &&
    #   !contains(github.event.pull_request.labels.*.name, 'no ci')

    steps:
      - name: Dump github context
        run: echo "$GITHUB_CONTEXT"
        env:
          GITHUB_CONTEXT: ${{ toJSON(github) }}

      - name: Dump env context
        run: echo "$ENV_CONTEXT"
        env:
          ENV_CONTEXT: ${{ toJSON(env) }}

      - name: Dump vars context
        run: echo "$VARS_CONTEXT"
        env:
          VARS_CONTEXT: ${{ toJSON(vars) }}

      - name: Dump environment variables
        run: env

      - name: Checkout pull request code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
          lfs: false
          # ref: ${{ github.head_ref }} # checkout named branch, not detached HEAD

      - name: Check git
        run: |
          git branch -a
          git status
